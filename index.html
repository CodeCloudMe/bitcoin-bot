<html>

<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>

<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

<script>

$(window).load(init);

function init(){
    getData();
    //getChart();
}

function getData(){
    $.getJSON('/cloud/models/btc/bfChart.php', function(resp){

    allOkcoinPrices = [];
	allOkcoinBids = [];
	allOkcoinAsks=[];
       
    allKorbitPrices = [];
	allKorbitBids = [];
	allKorbitAsks=[];

    allBitfinixPrices = [];
	allBitfinixBids = [];
	allBitfinixAsks=[];

    resp[0].reverse();
    resp[1].reverse();
    resp[2].reverse();

	//resp.reverse();

	//startTime = new Date(resp[0]['timestamp']).getTime();


	for (i in resp[0]){

        allOkcoinPrices.push([new Date(resp[0][i]['timestamp']).getTime(), parseFloat(resp[0][i]['price'])]);
	    allOkcoinBids.push([new Date(resp[0][i]['timestamp']).getTime(), parseFloat(resp[0][i]['bid'])]);
	    allOkcoinAsks.push([new Date(resp[0][i]['timestamp']).getTime(), parseFloat(resp[0][i]['ask'])]);

		}
	
	for (i in resp[1]){

        allKoritPrices.push([new Date(resp[1][i]['timestamp']).getTime(), parseFloat(resp[1][i]['price'])]);
	    allKorbitBids.push([new Date(resp[1][i]['timestamp']).getTime(), parseFloat(resp[1][i]['bid'])]);
	    allKorbitAsks.push([new Date(resp[1][i]['timestamp']).getTime(), parseFloat(resp[1][i]['ask'])]);

		}

	for (i in resp[2]){

        allBitfinixPrices.push([new Date(resp[2][i]['timestamp']).getTime(), parseFloat(resp[2][i]['price'])]);
	    allBitfinixBids.push([new Date(resp[2][i]['timestamp']).getTime(), parseFloat(resp[2][i]['bid'])]);
	    allBitfinixAsks.push([new Date(resp[2][i]['timestamp']).getTime(), parseFloat(resp[2][i]['ask'])]);

		}

    getChart(allOkcoinPrices, allOkcoinBids, allOkcoinAsks, allKorbitPrices, allKorbitBids, allKorbitAsks, allBitfinixPrices, allBitfinixBids, allBitfinixAsks);

	})
};


function  getChart(OkcoinPrices, OkcoinBids, OkcoinAsks, KorbitPrices, KorbitBids, KorbitAsks, BitfinixPrices, BitfinixBids, BitfinixAsks) {
    $('#container').highcharts({
        chart: {
            type: 'spline',
            zoomType:'x'
        },
        title: {
            text: 'Okcoin, Korbit and Bitfinix  prices'
        },
        subtitle: {
            text: 'Yup'
        },
        xAxis: {
            type: 'datetime',
           /* labels: {
                overflow: 'justify'
            }*/
        },
        yAxis: {
            title: {
                text: 'price'
            },
            //min: 0,
           // minorGridLineWidth: 0,
           // gridLineWidth: 0,
            alternateGridColor: null,
          
        },
        tooltip: {
            valueSuffix: ' $'
        },
        plotOptions: {
            spline: {
                lineWidth: 1,
                states: {
                    hover: {
                        lineWidth: 5
                    }
                },
                marker: {
                    enabled: true
                },
                //pointInterval: (1000* 60),
               // pointStart: startTimestamp
            }
        },

        series: [{
            name: 'Okcoin',
            data: OkcoinPrices

        },
       /* {
            name: 'Okcoin Ask',
            data: OkcoinAsks

        },
        {
            name: 'Okcoin Bids',
            data: OkcoinBids

        },*/

        name: 'Korbit',
            data: KorbitPrices

        },
       /* {
            name: 'Korbit Ask',
            data: KorbitAsks

        },
        {
            name: 'Korbit Bids',
            data: KorbitBids

        },*/

        name: 'Bitfinix',
            data: BitfinixPrices

        },
       /* {
            name: 'Bitfinix Ask',
            data: BitfinixAsks

        },
        {
            name: 'Bitfinix Bids',
            data: BitfinixBids

        },*/

        //add another here {name: 'ddd', data:lah}

        ],

        navigation: {
            menuItemStyle: {
                fontSize: '10px'
            }
        }
    });
};

</script>

</html>
